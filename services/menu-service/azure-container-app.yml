# Azure Container App YAML template for `menu-service`
# Replace placeholders (`<...>`) before deploying.
properties:
  kubeEnvironmentId: "/subscriptions/<SUBSCRIPTION_ID>/resourceGroups/<RG>/providers/Microsoft.Web/kubeEnvironments/<ENV_NAME>"
  configuration:
    ingress:
      external: true
      targetPort: 8080
    registries:
      - server: <ACR_LOGIN_SERVER> # e.g. myregistry.azurecr.io
        username: <ACR_USERNAME>
        password: <ACR_PASSWORD> # consider using Azure Key Vault or `az acr credential show`
  template:
    containers:
      - name: menu-service
        image: <ACR_LOGIN_SERVER>/menu-service:latest
        resources:
          cpu: 0.5
          memory: 1Gi
        env:
          - name: SPRING_PROFILES_ACTIVE
            value: "prod"
          - name: SPRING_DATASOURCE_URL
            value: "jdbc:mysql://<MYSQL_HOST>:3306/<DB_NAME>"
          - name: SPRING_DATA_MONGODB_URI
            value: "mongodb://<MONGO_USER>:<MONGO_PASS>@<MONGO_HOST>:27017/<DB_NAME>"
    scale:
      minReplicas: 1
      maxReplicas: 3
